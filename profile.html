<div id="profile-section">
  <p>Email: <span id="email"></span></p>
  <input type="text" id="full_name" />
  <textarea id="bio"></textarea>
  <button onclick="updateProfile()">Save</button>
</div>

<script type="module">
  import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';
  const supabase = createClient('https://xyz.supabase.co', 'your-anon-key');

  async function loadProfile() {
    const { data: { user } } = await supabase.auth.getUser();
    if (!user) return window.location.href = "login.html";

    const { data, error } = await supabase.from('users').select('*').eq('email', user.email).single();

    document.getElementById('email').innerText = user.email;
    document.getElementById('full_name').value = data.full_name;
    document.getElementById('bio').value = data.bio || '';
  }

  window.updateProfile = async function () {
    const full_name = document.getElementById('full_name').value;
    const bio = document.getElementById('bio').value;
    const { data: { user } } = await supabase.auth.getUser();

    await supabase.from('users').update({ full_name, bio }).eq('email', user.email);
    alert("Profile Updated!");
  }

  loadProfile();
</script>
